# CLAUDE.md

Этот файл предоставляет руководство для Claude Code (claude.ai/code) при работе с кодом в этом репозитории.

## Структура проекта

Highlight ERP - это двухкомпонентная система:

### Backend (highlight-erp/)
- **Фреймворк**: Laravel 12 с PHP 8.2+
- **API**: RESTful API с аутентификацией через Laravel Sanctum
- **База данных**: Миграции для управления схемой БД
- **Архитектура**: Repository pattern, отдельные контроллеры для Admin и Employee
- **Документация API**: Swagger (L5-Swagger)

### Frontend (highlight-erp_front/)
- **Фреймворк**: React 19 с TypeScript
- **Сборка**: Vite
- **Стилизация**: Tailwind CSS v4
- **Управление состоянием**: Zustand
- **Маршрутизация**: React Router DOM v7

## Команды разработки

### Backend (highlight-erp/)
```bash
# Запуск полной среды разработки (сервер + очереди + логи + Vite)
composer run dev

# Сборка фронтенд-ресурсов
npm run build

# Разработка с hot-reload
npm run dev

# Тестирование
composer run test
# или
php artisan test

# Очистка конфигурации
php artisan config:clear

# Запуск отдельных сервисов
php artisan serve
php artisan queue:listen --tries=1
php artisan pail --timeout=0

# Миграции
php artisan migrate

# Линтинг (Laravel Pint)
./vendor/bin/pint
```

### Frontend (highlight-erp_front/)
```bash
# Разработка
npm run dev

# Сборка для продакшена
npm run build

# Линтинг
npm run lint

# Предварительный просмотр сборки
npm run preview

# Проверка типов TypeScript
npx tsc --noEmit
```

## Архитектура системы

### Backend структура
- **app/Http/Controllers/Api/**: API контроллеры разделены по ролям (Admin/, Employee/)
- **app/Models/**: Eloquent модели (User, Document, DocumentUser, Position, Role)
- **app/Repositories/**: Repository pattern для работы с данными
- **routes/api.php**: API маршруты с комментариями на русском языке
- **database/migrations/**: Миграции для управления схемой БД

### Frontend структура
- **src/pages/**: React страницы
  - **LoginPage**: Страница входа в систему
  - **AdminDocumentsPage**: Страница списка документов администратора (карточный дизайн)
- **src/components/**: Переиспользуемые компоненты
  - **ProtectedRoute**: Компонент для защиты маршрутов
- **src/services/**: API клиенты и внешние сервисы
  - **auth.ts**: Сервис аутентификации
  - **adminDocuments.ts**: Сервис для работы с документами администратора
- **src/store/**: Zustand стейт менеджмент
- **src/hooks/**: Кастомные React хуки
- **src/types/**: TypeScript типы
  - **document.ts**: Типы для документов
- **src/utils/**: Утилитарные функции

### API Endpoints
- Публичные маршруты: аутентификация
- Защищенные маршруты требуют Bearer Token (Laravel Sanctum)
- Разделение по ролям: Admin и Employee контроллеры

## Конфигурация разработки

### Backend
- **Тестирование**: PHPUnit с Laravel testing utilities
- **Линтинг**: Laravel Pint
- **Логирование**: Laravel Pail для real-time логов
- **Очереди**: Laravel queues для фоновых задач

### Frontend
- **ESLint**: Настроен с React и TypeScript правилами
- **Prettier**: Для форматирования кода
- **TypeScript**: Строгая конфигурация с несколькими tsconfig файлами
- **PostCSS**: С Tailwind CSS и Autoprefixer

## Особенности проекта

1. **Многоязычность**: Комментарии в API роутах на русском языке
2. **Роли пользователей**: Четкое разделение между Admin и Employee функциональностью
3. **Документооборот**: Основная функциональность связана с документами и пользователями
4. **Современный стек**: Использует последние версии Laravel и React
5. **Полная интеграция**: Composer скрипт `dev` запускает все необходимые сервисы одновременно

## Окружение

- **PHP**: 8.2+
- **Node.js**: Требуется для сборки фронтенда
- **Composer**: Для управления PHP зависимостями
- **NPM**: Для управления JavaScript зависимостями

При работе с проектом всегда проверяйте оба компонента (backend и frontend), так как они тесно интегрированы.

## Текущий прогресс разработки

### Реализовано

#### Frontend
1. **Страница входа (LoginPage)**
   - Форма аутентификации с email и паролем
   - Интеграция с API аутентификации
   - Обработка ошибок и состояния загрузки

2. **Страница списка документов администратора (AdminDocumentsPage)**
   - Плашка с информацией о пользователе (аватар, ФИО, роль) по центру
   - Заголовок "Список документов" с зеленой кнопкой "Добавить"
   - Карточный дизайн документов:
     - Иконка скачивания в правом верхнем углу
     - Заголовок документа (крупный, жирный)
     - Описание документа (серый текст)
     - Кнопки: "Редактировать" (темная) и "Удалить" (красная с иконкой корзины)
   - Адаптивный дизайн:
     - Desktop: сетка из карточек
     - Tablet (768px): одна колонка карточек
     - Mobile (480px): уменьшенные размеры, но все элементы на своих местах
   - Интеграция с API: загрузка, удаление, скачивание документов
   - Состояния: загрузка, ошибка, пустой список

3. **Сервисы**
   - `auth.ts`: аутентификация, хранение токена
   - `adminDocuments.ts`: CRUD операции с документами

4. **Типы TypeScript**
   - `Document`: интерфейс для документов

5. **Компоненты**
   - `ProtectedRoute`: защита маршрутов для авторизованных пользователей

### В разработке / Планируется
- Страница создания/редактирования документа
- Страница просмотра документа
- Функционал для сотрудников (Employee)
- Управление пользователями
- Управление должностями и ролями